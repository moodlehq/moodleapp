---
phase: 02-custom-code-adaptation
plan: 08
type: code
wave: 2
depends_on: [02-01]
files_modified:
  - src/theme/theme.base.scss
  - src/theme/globals.variables.scss
  - src/theme/theme.custom.scss
  - src/theme/globals.custom.scss
autonomous: true

must_haves:
  truths:
    - "Theme SCSS files compile without errors"
    - "Aspire color scheme preserved"
    - "Custom styling for parent/mentee UI preserved"
    - "Grade color classes work (excellent/good/average/below/poor)"
  artifacts:
    - path: "src/theme/theme.base.scss"
      provides: "Base theme with Aspire customizations"
    - path: "src/theme/globals.variables.scss"
      provides: "CSS variables and design system tokens"
---

<objective>
Verify theme SCSS files are compatible with Ionic 8 and Angular 20 patterns.

Purpose: Theme files control the visual appearance. Aspire has custom color schemes and UI styling that must be preserved.

Output: Theme compiles without SCSS errors and all custom styling works.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-custom-code-adaptation/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify theme.base.scss compatibility</name>
  <files>src/theme/theme.base.scss</files>
  <action>
    Check for Ionic 8 CSS compatibility:

    1. **Dark palette targeting** (if present):
       - Old pattern: `body { ... }` for dark mode
       - New pattern: `:root { ... }` for dark mode

       If dark mode is defined on `body`, may need to move to `:root`.
       However, if file uses media queries like `@media (prefers-color-scheme: dark)`,
       this is already compatible.

    2. **Check for deprecated form control syntax**:
       - Legacy picker patterns should use `ion-picker-legacy`
       - Form controls should not use deprecated legacy syntax

    3. **Verify zoom ratio pattern** is present (already seen in file):
       ```scss
       :root {
           --zoom-ratio: 1;
           zoom: calc(100% * var(--zoom-ratio));
       }
       ```

    4. **Preserve Aspire customizations**:
       - Link colors
       - Typography classes
       - Responsive image styles
       - Flex utilities
       - Any Aspire-specific classes

    No major changes expected - SCSS is typically backward compatible.
  </action>
  <verify>
    SCSS will be verified during full build: `npm run build`
    For quick check: Ensure no SCSS syntax errors by visual inspection.
  </verify>
  <done>
    - Dark mode targeting is compatible
    - No deprecated form control syntax
    - Aspire customizations preserved
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify globals.variables.scss and design system</name>
  <files>src/theme/globals.variables.scss</files>
  <action>
    1. **Verify CSS variable naming**:
       - Ionic 8 may have renamed some variables
       - Check that custom variables follow `--core-*` or `--mdl-*` patterns

    2. **Verify color palette**:
       - Primary, secondary, tertiary colors defined
       - Grade colors defined (if in this file):
         - `--grade-excellent` or similar
         - `--grade-good`
         - `--grade-average`
         - `--grade-below`
         - `--grade-poor`

    3. **Check for Ionic 8 variable changes**:
       - `--ion-color-*` patterns should still work
       - Safe area variables should use new patterns if needed

    4. **Preserve Aspire design tokens**:
       - Typography font variables
       - Spacing variables
       - Border radius variables
  </action>
  <verify>
    Variables will be verified during full build.
    Check that all variables referenced in components are defined.
  </verify>
  <done>
    - CSS variables properly defined
    - Grade colors present
    - Design system tokens intact
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify custom theme files</name>
  <files>
    src/theme/theme.custom.scss
    src/theme/globals.custom.scss
  </files>
  <action>
    These are Aspire-specific custom theme files:

    1. **Verify theme.custom.scss**:
       - Contains Aspire-specific component styling
       - Parent/mentee UI styles
       - Grade card styling
       - App links section styling

    2. **Verify globals.custom.scss**:
       - Contains Aspire-specific variables
       - Custom color overrides
       - Any design system extensions

    3. **Check for deprecated patterns**:
       - Deep selectors: `::ng-deep` is deprecated but still works
       - `/deep/` or `>>>` are removed - should use `::ng-deep` if needed
       - Host context: `:host-context()` should work

    No major changes expected - custom SCSS is typically self-contained.
  </action>
  <verify>
    Custom SCSS will be verified during full build.
  </verify>
  <done>
    - theme.custom.scss has Aspire styling
    - globals.custom.scss has Aspire variables
    - No deprecated selector syntax
  </done>
</task>

</tasks>

<verification>
SCSS compilation is verified during full build:
```bash
npm run build 2>&1 | grep -i "scss\|sass\|style" | head -20
```

Check for deprecated patterns:
```bash
grep -rn "/deep/\|>>>" src/theme/ 2>/dev/null
```
Should return nothing (these selectors are removed).

Verify grade color classes exist:
```bash
grep -rn "grade-excellent\|grade-good\|grade-average\|grade-below\|grade-poor" src/theme/
```
</verification>

<success_criteria>
- THM-01: theme.base.scss customizations preserved (zoom, typography, utilities)
- THM-02: globals.variables.scss has all required variables
- THM-03: Custom theme files have Aspire styling (parent UI, grades)
- THM-04: No deprecated SCSS syntax
- SCSS compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-custom-code-adaptation/02-08-SUMMARY.md`
</output>
