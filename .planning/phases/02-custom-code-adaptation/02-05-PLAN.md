---
phase: 02-custom-code-adaptation
plan: 05
type: code
wave: 2
depends_on: [02-01]
files_modified:
  - src/core/features/course/components/course-section/course-section.ts
  - src/core/features/course/components/course-section/course-section.html
  - src/core/features/course/components/course-section/course-section.scss
  - src/core/features/course/components/module/module.ts
  - src/core/features/course/pages/index/index.ts
autonomous: true

must_haves:
  truths:
    - "Course section component compiles without TypeScript errors"
    - "Module component compiles without TypeScript errors"
    - "Course index page compiles without TypeScript errors"
    - "Course section styling preserved"
  artifacts:
    - path: "src/core/features/course/components/course-section/course-section.ts"
      provides: "Course section component with collapsible sections"
      exports: ["CoreCourseSectionComponent"]
    - path: "src/core/features/course/components/module/module.ts"
      provides: "Course module component"
    - path: "src/core/features/course/pages/index/index.ts"
      provides: "Course index page"
---

<objective>
Fix course component import issues and ensure course section/module styling is preserved.

Purpose: Course components display the course content structure. Any Aspire styling customizations must be preserved.

Output: Course components compile and display correctly.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-custom-code-adaptation/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix course-section.ts imports</name>
  <files>src/core/features/course/components/course-section/course-section.ts</files>
  <action>
    Based on research, check for these import patterns:

    1. **Verify overlay service imports** (if used):
       - Old: `@services/loadings` -> New: `@services/overlays/loadings`
       - Old: `@services/toasts` -> New: `@services/overlays/toasts`
       - Old: `@services/modals` -> New: `@services/overlays/modals`
       - Old: `@services/popovers` -> New: `@services/overlays/popovers`

    2. **Verify Angular imports**:
       - Component, Input, Output, EventEmitter from @angular/core
       - @HostBinding if used (seen in code)

    3. **Verify module imports array**:
       - CoreSharedModule should be imported
       - CoreCourseModuleComponent should be imported

    4. **Check for duplicate host bindings**:
       The file has both `host: { '[class]': ... }` in decorator AND `@HostBinding('class')`.
       This is redundant. Remove the @HostBinding decorator since the host property in @Component serves the same purpose.

       Remove:
       ```typescript
       @HostBinding('class')
           get collapsibleClass(): string {
               return this.collapsible ? 'collapsible' : 'non-collapsible';
           }
       ```
       Keep the `host` property in @Component decorator which already has:
       ```typescript
       host: {
           '[class]': 'collapsible ? "collapsible" : "non-collapsible"',
       },
       ```
  </action>
  <verify>
    Run: `npx tsc --noEmit src/core/features/course/components/course-section/course-section.ts 2>&1 | head -20`
  </verify>
  <done>
    - All imports use correct paths
    - No duplicate host bindings
    - No TypeScript errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix module.ts and index.ts imports</name>
  <files>
    src/core/features/course/components/module/module.ts
    src/core/features/course/pages/index/index.ts
  </files>
  <action>
    1. **Check module.ts**:
       - Verify overlay service import paths
       - Verify Angular imports
       - Verify component imports array

    2. **Check index.ts (course index page)**:
       - Verify overlay service import paths
       - Check for CoreAlerts, CoreToasts, CoreLoadings usage
       - Verify any FAB-related customizations (Course Index FAB for Aspire)

    Update any imports following the pattern:
    - `@services/loadings` -> `@services/overlays/loadings`
    - `@services/toasts` -> `@services/overlays/toasts`
    - `@services/alerts` -> `@services/overlays/alerts`
  </action>
  <verify>
    Run: `npx tsc --noEmit src/core/features/course/components/module/module.ts src/core/features/course/pages/index/index.ts 2>&1 | head -30`
  </verify>
  <done>
    - module.ts compiles without errors
    - index.ts compiles without errors
    - Course Index FAB customization preserved (if present)
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify templates and SCSS</name>
  <files>
    src/core/features/course/components/course-section/course-section.html
    src/core/features/course/components/course-section/course-section.scss
  </files>
  <action>
    1. **Verify course-section.html**:
       - Template bindings match component properties
       - collapsible behavior bindings present
       - sectionClicked event handler present

    2. **Verify course-section.scss**:
       - No deprecated SCSS syntax
       - Aspire styling customizations preserved (if any)

    No code changes expected if files are already compatible.
  </action>
  <verify>
    Template bindings should match component class properties and methods.
  </verify>
  <done>
    - Templates match component classes
    - SCSS is valid and has any Aspire customizations
  </done>
</task>

</tasks>

<verification>
Run TypeScript check on course components:
```bash
npx tsc --noEmit \
  src/core/features/course/components/course-section/course-section.ts \
  src/core/features/course/components/module/module.ts \
  src/core/features/course/pages/index/index.ts \
  2>&1 | head -30
```

Check for old import paths:
```bash
grep -rn "@services/loadings\|@services/toasts\|@services/alerts" \
  src/core/features/course/components/ \
  src/core/features/course/pages/index/ \
  2>/dev/null | grep -v overlays
```
Should return nothing (all paths should include /overlays/).
</verification>

<success_criteria>
- CRS-01: Course section customizations preserved (collapsible behavior)
- CRS-02: Course module styling preserved
- CRS-03: Course index page tweaks intact (FAB if present)
- CRS-04: All import paths updated to new overlay service pattern
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-custom-code-adaptation/02-05-SUMMARY.md`
</output>
