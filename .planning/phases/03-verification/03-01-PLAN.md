---
phase: 03-verification
plan: 01
type: verify
wave: 1
depends_on: []
files_modified: []
autonomous: true

must_haves:
  truths:
    - "npm run build completes with zero errors"
    - "All Aspire customizations are functional"
    - "Parent/mentee system works"
    - "YouTube proxy handles iOS embeds"
  artifacts:
    - path: "www/"
      provides: "Compiled app bundle"
      note: "Created by successful build"
---

<objective>
Verify the merged and adapted codebase builds successfully and all custom features work.

Purpose: Confirm Phase 1 (merge) and Phase 2 (adaptation) produced a working app. This is the final verification before the merge is considered complete.

Output: Build verification report and manual testing checklist.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run TypeScript compilation check</name>
  <files>None - verification only</files>
  <action>
    Run TypeScript compilation to check for errors:

    ```bash
    npx tsc --noEmit 2>&1 | head -100
    ```

    If errors found:
    1. Categorize errors by file
    2. Identify if they're in Phase 2 target files or elsewhere
    3. Fix critical errors that block build
    4. Document any remaining warnings

    Common fixes needed:
    - Missing imports (add them)
    - Type mismatches (fix signatures)
    - Undefined variables (check merge artifacts)
  </action>
  <verify>
    Run: `npx tsc --noEmit 2>&1 | grep -c "error TS" || echo "0"`
    Should return 0 (no TypeScript errors)
  </verify>
  <done>
    - TypeScript compilation passes OR
    - All blocking errors fixed and documented
  </done>
</task>

<task type="auto">
  <name>Task 2: Run full production build</name>
  <files>None - verification only</files>
  <action>
    Run the production build:

    ```bash
    npm run build 2>&1 | tail -50
    ```

    This will:
    1. Compile TypeScript
    2. Bundle Angular app
    3. Compile SCSS
    4. Create www/ output

    If build fails:
    1. Identify the error type (TS, SCSS, Angular, Webpack)
    2. Fix the blocking issue
    3. Re-run build
    4. Document what was fixed

    Expected output: Build completes with "Build complete" message
  </action>
  <verify>
    Run: `ls -la www/index.html 2>/dev/null && echo "BUILD_SUCCESS" || echo "BUILD_FAILED"`
    Should show www/index.html exists
  </verify>
  <done>
    - www/ directory created with compiled app
    - No fatal build errors
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify custom feature files exist and compile</name>
  <files>None - verification only</files>
  <action>
    Verify all custom Aspire features are present and functional:

    1. **YouTube Proxy:**
       ```bash
       grep -l "youtube-proxy" src/core/singletons/url.ts && echo "YouTube proxy: PRESENT"
       ```

    2. **Parent/Mentee System:**
       ```bash
       grep -l "getMentees\|isParentUser" src/core/features/user/services/parent.ts && echo "Parent service: PRESENT"
       grep -l "mentees\|selectMentee" src/core/features/mainmenu/components/user-menu/user-menu.ts && echo "User menu mentee: PRESENT"
       ```

    3. **Debug Console:**
       ```bash
       grep -l "onBuildNumberTap\|debugTapCount" src/core/features/mainmenu/components/user-menu/user-menu.ts && echo "Debug console: PRESENT"
       ```

    4. **App Links:**
       ```bash
       grep -l "CoreAppLinks\|getAppLinkSections" src/core/features/mainmenu/components/user-menu/user-menu.ts && echo "App links: PRESENT"
       ```

    5. **LightboxGallery Addon:**
       ```bash
       ls src/addons/mod/lightboxgallery/ && echo "LightboxGallery: PRESENT"
       ```

    6. **Custom Theme:**
       ```bash
       ls -la src/theme/theme.custom.scss && echo "Custom theme: PRESENT"
       ```

    Document which features are present and verified.
  </action>
  <verify>
    All 6 custom features should show "PRESENT"
  </verify>
  <done>
    - All custom features verified present
    - No missing customizations from merge
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. TypeScript compiles without errors
2. Production build succeeds (www/ exists)
3. All custom features verified present:
   - YouTube proxy
   - Parent/mentee system
   - Debug console 7-tap
   - App links
   - LightboxGallery addon
   - Custom theme

Note: Runtime testing (login, UI interaction) requires manual verification.
</verification>

<success_criteria>
- VER-01: Build completes with zero errors
- VER-02: www/index.html exists after build
- VER-03: Parent/mentee code present
- VER-04: Grades files present (verified in Phase 2)
- VER-05: User menu customizations present
- VER-06: Course Index files present (verified in Phase 2)
- VER-07: LightboxGallery addon exists
- VER-08: YouTube proxy code present
</success_criteria>

<output>
After completion, create `.planning/phases/03-verification/03-01-SUMMARY.md`
</output>
